
remove-frames-content.js application/javascript
(function() {
	var log = console.log.bind(console);
	var url = 'unknown';
	try {
		url = window.location.href || url;
	} catch (e) {};
	function inIframe() {
		try {
			return window.self !== window.top;
		} catch (e) {}
		return true;
	}
	function removeHead() {
		try {
			// This is sometimes causing 100% CPU usage.
			//document.head.parentNode.removeChild(document.head);
			document.head.innerHTML = '';
			return true;
		} catch (e) {}
		return false;
	}
	function removeBody() {
		try {
			document.body.parentNode.removeChild(document.body);
			return true;
		} catch (e) {};
		return false;
	}
	function logRemoval(type, async, result) {
		log('uBO> Removed frame contents. ['+ type +':%s] [ASYNC:%s] [URL:%s]', async, result, url);
	}
	if (inIframe()) {
		if (document.head) {
			logRemoval('HEAD', false, removeHead());
		} else {
			setTimeout(function() {
				logRemoval('HEAD', true, removeHead());
			}, 0);
		}
		if (document.body) {
			logRemoval('BODY', false, removeBody());
		} else {
			setTimeout(function() {
				logRemoval('BODY', true, removeBody());
			}, 0);
		}
	}
})();